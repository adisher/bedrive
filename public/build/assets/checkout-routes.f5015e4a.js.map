{"version":3,"file":"checkout-routes.f5015e4a.js","sources":["../../../common/resources/client/auth/guards/not-subscribed-route.tsx","../../../common/resources/client/billing/checkout/checkout-layout.tsx","../../../common/resources/client/billing/requests/use-checkout-product.ts","../../../common/resources/client/billing/checkout/checkout-product-summary.tsx","../../../node_modules/@paypal/paypal-js/dist/esm/paypal-js.js","../../../common/resources/client/billing/checkout/paypal/use-paypal.ts","../../../common/resources/client/billing/checkout/checkout.tsx","../../../common/resources/client/billing/checkout/stripe/checkout-stripe-done.tsx","../../../common/resources/client/billing/checkout/paypal/checkout-paypal-done.tsx","../../../common/resources/client/billing/checkout/checkout-routes.tsx"],"sourcesContent":["import {useAuth} from '../use-auth';\nimport {ReactElement} from 'react';\nimport {Navigate, Outlet} from 'react-router-dom';\n\ninterface GuestRouteProps {\n  children: ReactElement;\n}\nexport function NotSubscribedRoute({children}: GuestRouteProps) {\n  const {isLoggedIn, isSubscribed} = useAuth();\n\n  if (!isLoggedIn) {\n    return <Navigate to=\"/register\" replace />;\n  }\n\n  if (isLoggedIn && isSubscribed) {\n    return <Navigate to=\"/billing\" replace />;\n  }\n\n  return children || <Outlet />;\n}\n","import {ReactElement, useEffect} from 'react';\nimport {Navbar} from '../../ui/navigation/navbar/navbar';\nimport {CustomMenu} from '../../menus/custom-menu';\nimport {LocaleSwitcher} from '../../i18n/locale-switcher';\nimport {removeFromLocalStorage} from '../../utils/hooks/local-storage';\nimport {StaticPageTitle} from '../../seo/static-page-title';\nimport {Trans} from '../../i18n/trans';\n\ninterface CheckoutLayoutProps {\n  children: [ReactElement, ReactElement];\n}\nexport function CheckoutLayout({children}: CheckoutLayoutProps) {\n  const [left, right] = children;\n\n  useEffect(() => {\n    removeFromLocalStorage('be.onboarding.selected');\n  }, []);\n\n  return (\n    <div className=\"flex flex-col h-full overflow-y-auto\">\n      <StaticPageTitle>\n        <Trans message=\"Checkout\" />\n      </StaticPageTitle>\n      <Navbar\n        size=\"sm\"\n        color=\"transparent\"\n        className=\"flex-shrink-0 z-10 mb-20 md:mb-0\"\n        textColor=\"text-main\"\n        logoColor=\"dark\"\n        darkModeColor=\"transparent\"\n        menuPosition=\"checkout-page-navbar\"\n      />\n      <div className=\"flex-auto md:flex w-full mx-auto justify-between px-20 md:px-0 md:pt-128 md:max-w-950\">\n        <div className=\"hidden md:block fixed right-0 top-0 w-1/2 h-full bg-alt shadow-[15px_0_30px_0_rgb(0_0_0_/_18%)]\" />\n        <div className=\"md:w-400 overflow-hidden\">\n          {left}\n          <CustomMenu\n            menu=\"checkout-page-footer\"\n            className=\"text-xs mt-50 text-muted overflow-x-auto\"\n          />\n          <div className=\"mt-40\">\n            <LocaleSwitcher />\n          </div>\n        </div>\n        <div className=\"hidden md:block w-384\">\n          <div className=\"relative z-10\">{right}</div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import {useQuery} from '@tanstack/react-query';\nimport {apiClient} from '../../http/query-client';\nimport {BackendResponse} from '../../http/backend-response/backend-response';\nimport {Product} from '../product';\nimport {useParams} from 'react-router-dom';\n\nconst endpoint = (productId: string | number) =>\n  `billing/products/${productId}`;\n\nexport interface FetchProductResponse extends BackendResponse {\n  product: Product;\n}\n\nexport function useCheckoutProduct() {\n  const {productId, priceId} = useParams();\n  const query = useQuery(\n    [endpoint(productId!)],\n    () => fetchProduct(productId!),\n    {\n      keepPreviousData: true,\n      enabled: productId != null && priceId != null,\n    }\n  );\n\n  const product = query.data?.product;\n  const price =\n    product?.prices.find(p => p.id === parseInt(priceId!)) ||\n    product?.prices[0];\n\n  return {status: query.status, product, price};\n}\n\nfunction fetchProduct(\n  productId: string | number\n): Promise<FetchProductResponse> {\n  return apiClient.get(endpoint(productId)).then(response => response.data);\n}\n","import {Trans} from '../../i18n/trans';\nimport {FormattedPrice} from '../../i18n/formatted-price';\nimport {useCheckoutProduct} from '../requests/use-checkout-product';\nimport {m} from 'framer-motion';\nimport {Skeleton} from '../../ui/skeleton/skeleton';\nimport {Product} from '../product';\nimport {Price} from '../price';\nimport {FormattedCurrency} from '../../i18n/formatted-currency';\nimport {ProductFeatureList} from '../pricing-table/product-feature-list';\nimport {opacityAnimation} from '../../ui/animation/opacity-animation';\n\ninterface CheckoutProductSummaryProps {\n  showBillingLine?: boolean;\n}\nexport function CheckoutProductSummary({\n  showBillingLine = true,\n}: CheckoutProductSummaryProps) {\n  const {status, product, price} = useCheckoutProduct();\n\n  if (status === 'error' || (status !== 'loading' && (!product || !price))) {\n    return null;\n  }\n\n  return (\n    <div>\n      <h2 className=\"text-2xl mb-30\">\n        <Trans message=\"Summary\" />\n      </h2>\n      {status === 'loading' ? (\n        <LoadingSkeleton key=\"loading-skeleton\" />\n      ) : (\n        <ProductSummary\n          product={product!}\n          price={price!}\n          showBillingLine={showBillingLine}\n        />\n      )}\n    </div>\n  );\n}\n\ninterface ProductSummaryProps {\n  product: Product;\n  price: Price;\n  showBillingLine: boolean;\n}\nfunction ProductSummary({\n  product,\n  price,\n  showBillingLine,\n}: ProductSummaryProps) {\n  return (\n    <m.div>\n      <div className=\"text-xl font-semibold mb-6\">{product.name}</div>\n      {product.description && (\n        <div className=\"text-sm text-muted\">{product.description}</div>\n      )}\n      <FormattedPrice\n        priceClassName=\"font-bold text-4xl\"\n        periodClassName=\"text-muted text-xs\"\n        variant=\"separateLine\"\n        price={price}\n        className=\"mt-32\"\n      />\n      <ProductFeatureList product={product} />\n      {showBillingLine && (\n        <div className=\"flex items-center justify-between gap-24 border-t pt-24 mt-32 font-medium\">\n          <div>\n            <Trans message=\"Billed today\" />\n          </div>\n          <div>\n            <FormattedCurrency value={price.amount} currency={price.currency} />\n          </div>\n        </div>\n      )}\n    </m.div>\n  );\n}\n\nfunction LoadingSkeleton() {\n  return (\n    <m.div {...opacityAnimation} className=\"max-w-180\">\n      <Skeleton className=\"text-xl mb-6\" />\n      <Skeleton className=\"text-sm\" />\n      <Skeleton className=\"text-4xl mt-32\" />\n    </m.div>\n  );\n}\n","/*!\n * paypal-js v5.1.5 (2023-03-21T20:10:17.743Z)\n * Copyright 2020-present, PayPal, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction findScript(url, attributes) {\n    var currentScript = document.querySelector(\"script[src=\\\"\".concat(url, \"\\\"]\"));\n    if (currentScript === null)\n        return null;\n    var nextScript = createScriptElement(url, attributes);\n    // ignore the data-uid-auto attribute that gets auto-assigned to every script tag\n    var currentScriptClone = currentScript.cloneNode();\n    delete currentScriptClone.dataset.uidAuto;\n    // check if the new script has the same number of data attributes\n    if (Object.keys(currentScriptClone.dataset).length !==\n        Object.keys(nextScript.dataset).length) {\n        return null;\n    }\n    var isExactMatch = true;\n    // check if the data attribute values are the same\n    Object.keys(currentScriptClone.dataset).forEach(function (key) {\n        if (currentScriptClone.dataset[key] !== nextScript.dataset[key]) {\n            isExactMatch = false;\n        }\n    });\n    return isExactMatch ? currentScript : null;\n}\nfunction insertScriptElement(_a) {\n    var url = _a.url, attributes = _a.attributes, onSuccess = _a.onSuccess, onError = _a.onError;\n    var newScript = createScriptElement(url, attributes);\n    newScript.onerror = onError;\n    newScript.onload = onSuccess;\n    document.head.insertBefore(newScript, document.head.firstElementChild);\n}\nfunction processOptions(options) {\n    var sdkBaseURL = \"https://www.paypal.com/sdk/js\";\n    if (options.sdkBaseURL) {\n        sdkBaseURL = options.sdkBaseURL;\n        delete options.sdkBaseURL;\n    }\n    processMerchantID(options);\n    var _a = Object.keys(options)\n        .filter(function (key) {\n        return (typeof options[key] !== \"undefined\" &&\n            options[key] !== null &&\n            options[key] !== \"\");\n    })\n        .reduce(function (accumulator, key) {\n        var value = options[key].toString();\n        if (key.substring(0, 5) === \"data-\") {\n            accumulator.dataAttributes[key] = value;\n        }\n        else {\n            accumulator.queryParams[key] = value;\n        }\n        return accumulator;\n    }, {\n        queryParams: {},\n        dataAttributes: {},\n    }), queryParams = _a.queryParams, dataAttributes = _a.dataAttributes;\n    return {\n        url: \"\".concat(sdkBaseURL, \"?\").concat(objectToQueryString(queryParams)),\n        dataAttributes: dataAttributes,\n    };\n}\nfunction objectToQueryString(params) {\n    var queryString = \"\";\n    Object.keys(params).forEach(function (key) {\n        if (queryString.length !== 0)\n            queryString += \"&\";\n        queryString += key + \"=\" + params[key];\n    });\n    return queryString;\n}\n/**\n * Parse the error message code received from the server during the script load.\n * This function search for the occurrence of this specific string \"/* Original Error:\".\n *\n * @param message the received error response from the server\n * @returns the content of the message if the string string was found.\n *          The whole message otherwise\n */\nfunction parseErrorMessage(message) {\n    var originalErrorText = message.split(\"/* Original Error:\")[1];\n    return originalErrorText\n        ? originalErrorText.replace(/\\n/g, \"\").replace(\"*/\", \"\").trim()\n        : message;\n}\nfunction createScriptElement(url, attributes) {\n    if (attributes === void 0) { attributes = {}; }\n    var newScript = document.createElement(\"script\");\n    newScript.src = url;\n    Object.keys(attributes).forEach(function (key) {\n        newScript.setAttribute(key, attributes[key]);\n        if (key === \"data-csp-nonce\") {\n            newScript.setAttribute(\"nonce\", attributes[\"data-csp-nonce\"]);\n        }\n    });\n    return newScript;\n}\nfunction processMerchantID(options) {\n    var merchantID = options[\"merchant-id\"], dataMerchantID = options[\"data-merchant-id\"];\n    var newMerchantID = \"\";\n    var newDataMerchantID = \"\";\n    if (Array.isArray(merchantID)) {\n        if (merchantID.length > 1) {\n            newMerchantID = \"*\";\n            newDataMerchantID = merchantID.toString();\n        }\n        else {\n            newMerchantID = merchantID.toString();\n        }\n    }\n    else if (typeof merchantID === \"string\" && merchantID.length > 0) {\n        newMerchantID = merchantID;\n    }\n    else if (typeof dataMerchantID === \"string\" &&\n        dataMerchantID.length > 0) {\n        newMerchantID = \"*\";\n        newDataMerchantID = dataMerchantID;\n    }\n    options[\"merchant-id\"] = newMerchantID;\n    options[\"data-merchant-id\"] = newDataMerchantID;\n    return options;\n}\n\n/**\n * Load the Paypal JS SDK script asynchronously.\n *\n * @param {Object} options - used to configure query parameters and data attributes for the JS SDK.\n * @param {PromiseConstructor} [PromisePonyfill=window.Promise] - optional Promise Constructor ponyfill.\n * @return {Promise<Object>} paypalObject - reference to the global window PayPal object.\n */\nfunction loadScript(options, PromisePonyfill) {\n    if (PromisePonyfill === void 0) { PromisePonyfill = getDefaultPromiseImplementation(); }\n    validateArguments(options, PromisePonyfill);\n    // resolve with null when running in Node or Deno\n    if (typeof document === \"undefined\")\n        return PromisePonyfill.resolve(null);\n    var _a = processOptions(options), url = _a.url, dataAttributes = _a.dataAttributes;\n    var namespace = dataAttributes[\"data-namespace\"] || \"paypal\";\n    var existingWindowNamespace = getPayPalWindowNamespace(namespace);\n    // resolve with the existing global paypal namespace when a script with the same params already exists\n    if (findScript(url, dataAttributes) && existingWindowNamespace) {\n        return PromisePonyfill.resolve(existingWindowNamespace);\n    }\n    return loadCustomScript({\n        url: url,\n        attributes: dataAttributes,\n    }, PromisePonyfill).then(function () {\n        var newWindowNamespace = getPayPalWindowNamespace(namespace);\n        if (newWindowNamespace) {\n            return newWindowNamespace;\n        }\n        throw new Error(\"The window.\".concat(namespace, \" global variable is not available.\"));\n    });\n}\n/**\n * Load a custom script asynchronously.\n *\n * @param {Object} options - used to set the script url and attributes.\n * @param {PromiseConstructor} [PromisePonyfill=window.Promise] - optional Promise Constructor ponyfill.\n * @return {Promise<void>} returns a promise to indicate if the script was successfully loaded.\n */\nfunction loadCustomScript(options, PromisePonyfill) {\n    if (PromisePonyfill === void 0) { PromisePonyfill = getDefaultPromiseImplementation(); }\n    validateArguments(options, PromisePonyfill);\n    var url = options.url, attributes = options.attributes;\n    if (typeof url !== \"string\" || url.length === 0) {\n        throw new Error(\"Invalid url.\");\n    }\n    if (typeof attributes !== \"undefined\" && typeof attributes !== \"object\") {\n        throw new Error(\"Expected attributes to be an object.\");\n    }\n    return new PromisePonyfill(function (resolve, reject) {\n        // resolve with undefined when running in Node or Deno\n        if (typeof document === \"undefined\")\n            return resolve();\n        insertScriptElement({\n            url: url,\n            attributes: attributes,\n            onSuccess: function () { return resolve(); },\n            onError: function () {\n                var defaultError = new Error(\"The script \\\"\".concat(url, \"\\\" failed to load.\"));\n                if (!window.fetch) {\n                    return reject(defaultError);\n                }\n                // Fetch the error reason from the response body for validation errors\n                return fetch(url)\n                    .then(function (response) {\n                    if (response.status === 200) {\n                        reject(defaultError);\n                    }\n                    return response.text();\n                })\n                    .then(function (message) {\n                    var parseMessage = parseErrorMessage(message);\n                    reject(new Error(parseMessage));\n                })\n                    .catch(function (err) {\n                    reject(err);\n                });\n            },\n        });\n    });\n}\nfunction getDefaultPromiseImplementation() {\n    if (typeof Promise === \"undefined\") {\n        throw new Error(\"Promise is undefined. To resolve the issue, use a Promise polyfill.\");\n    }\n    return Promise;\n}\nfunction getPayPalWindowNamespace(namespace) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return window[namespace];\n}\nfunction validateArguments(options, PromisePonyfill) {\n    if (typeof options !== \"object\" || options === null) {\n        throw new Error(\"Expected an options object.\");\n    }\n    if (typeof PromisePonyfill !== \"undefined\" &&\n        typeof PromisePonyfill !== \"function\") {\n        throw new Error(\"Expected PromisePonyfill to be a function.\");\n    }\n}\n\n// replaced with the package.json version at build time\nvar version = \"5.1.5\";\n\nexport { loadCustomScript, loadScript, version };\n","import {useEffect, useRef, useState} from 'react';\nimport {loadScript} from '@paypal/paypal-js';\nimport {useProducts} from '../../pricing-table/use-products';\nimport {useSettings} from '../../../core/settings/use-settings';\n\ninterface UsePaypalProps {\n  productId?: string;\n  priceId?: string;\n}\nexport function usePaypal({productId, priceId}: UsePaypalProps) {\n  const {data} = useProducts();\n  const paypalLoadStarted = useRef<boolean>(false);\n  const paypalButtonsRendered = useRef<boolean>(false);\n  const [paypalIsLoaded, setPaypalIsLoaded] = useState(false);\n  const paypalElementRef = useRef<HTMLDivElement>(null);\n  const {\n    base_url,\n    billing: {\n      stripe: {enable: stripeEnabled},\n      paypal: {enable: paypalEnabled, public_key},\n    },\n  } = useSettings();\n\n  useEffect(() => {\n    if (!paypalEnabled || !public_key || paypalLoadStarted.current) return;\n    loadScript({\n      'client-id': public_key,\n      intent: 'subscription',\n      vault: true,\n      'disable-funding': stripeEnabled ? 'card' : undefined,\n    }).then(() => {\n      setPaypalIsLoaded(true);\n    });\n    paypalLoadStarted.current = true;\n  }, [public_key, paypalEnabled, stripeEnabled]);\n\n  useEffect(() => {\n    if (\n      !paypalIsLoaded ||\n      !window.paypal?.Buttons ||\n      !paypalElementRef.current ||\n      !data?.products.length ||\n      !productId ||\n      !priceId ||\n      paypalButtonsRendered.current\n    )\n      return;\n\n    const product = data.products.find(p => p.id === parseInt(productId));\n    const price = product?.prices.find(p => p.id === parseInt(priceId));\n\n    window.paypal\n      .Buttons({\n        style: {\n          label: 'pay',\n        },\n        createSubscription: (data, actions) => {\n          return actions.subscription.create({\n            application_context: {\n              shipping_preference: 'NO_SHIPPING',\n            },\n            plan_id: price?.paypal_id!,\n          });\n        },\n        onApprove: (data, actions) => {\n          actions.redirect(\n            `${base_url}/checkout/${productId}/${priceId}/paypal/done?subscriptionId=${data.subscriptionID}&status=success`\n          );\n          return Promise.resolve();\n        },\n        onError: e => {\n          location.href = `${base_url}/checkout/${productId}/${priceId}/paypal/done?status=error`;\n        },\n      })\n      .render(paypalElementRef.current)\n      .then(() => {\n        paypalButtonsRendered.current = true;\n      });\n  }, [productId, priceId, data, paypalIsLoaded, base_url]);\n\n  return {\n    paypalElementRef,\n    stripeIsEnabled: public_key != null && paypalEnabled,\n  };\n}\n","import {Navigate, useParams} from 'react-router-dom';\nimport {Trans} from '../../i18n/trans';\nimport {CheckoutLayout} from './checkout-layout';\nimport {CheckoutProductSummary} from './checkout-product-summary';\nimport {usePaypal} from './paypal/use-paypal';\nimport {StripeElementsForm} from './stripe/stripe-elements-form';\nimport {Fragment} from 'react';\nimport {useProducts} from '../pricing-table/use-products';\nimport {FullPageLoader} from '../../ui/progress/full-page-loader';\nimport {useSettings} from '../../core/settings/use-settings';\n\nexport function Checkout() {\n  const {productId, priceId} = useParams();\n  const productQuery = useProducts();\n  const {paypalElementRef} = usePaypal({\n    productId,\n    priceId,\n  });\n  const {\n    base_url,\n    billing: {stripe},\n  } = useSettings();\n\n  if (productQuery.isLoading) {\n    return <FullPageLoader />;\n  }\n\n  const product = productQuery.data?.products.find(\n    p => p.id === parseInt(productId!)\n  );\n  const price = product?.prices.find(p => p.id === parseInt(priceId!));\n\n  // make sure product and price exists in backend\n  if (!product || !price || productQuery.status === 'error') {\n    return <Navigate to=\"/pricing\" replace />;\n  }\n\n  return (\n    <CheckoutLayout>\n      <Fragment>\n        <h1 className=\"text-4xl mb-40\">\n          <Trans message=\"Checkout\" />\n        </h1>\n        {stripe.enable ? (\n          <Fragment>\n            <StripeElementsForm\n              productId={productId}\n              submitLabel={<Trans message=\"Upgrade\" />}\n              type=\"subscription\"\n              returnUrl={`${base_url}/checkout/${productId}/${priceId}/stripe/done`}\n            />\n            <Separator />\n          </Fragment>\n        ) : null}\n        <div ref={paypalElementRef} />\n        <div className=\"text-xs text-muted mt-30\">\n          <Trans message=\"You’ll be charged until you cancel your subscription. Previous charges won’t be refunded when you cancel unless it’s legally required. Your payment data is encrypted and secure. By subscribing your agree to our terms of service and privacy policy.\" />\n        </div>\n      </Fragment>\n      <CheckoutProductSummary />\n    </CheckoutLayout>\n  );\n}\n\nfunction Separator() {\n  return (\n    <div className=\"relative text-center my-20 before:absolute before:left-0 before:top-1/2 before:-translate-y-1/2 before:h-1 before:w-full before:bg-divider\">\n      <span className=\"bg relative z-10 px-10 text-sm text-muted\">\n        <Trans message=\"or\" />\n      </span>\n    </div>\n  );\n}\n","import {CheckoutLayout} from '../checkout-layout';\nimport {useParams, useSearchParams} from 'react-router-dom';\nimport {loadStripe, PaymentIntent} from '@stripe/stripe-js';\nimport {useEffect, useRef, useState} from 'react';\nimport {message} from '../../../i18n/message';\nimport {CheckoutProductSummary} from '../checkout-product-summary';\nimport {\n  BillingRedirectMessage,\n  BillingRedirectMessageConfig,\n} from '../../billing-redirect-message';\nimport {useNavigate} from '../../../utils/hooks/use-navigate';\nimport {apiClient} from '../../../http/query-client';\nimport {useSettings} from '../../../core/settings/use-settings';\nimport {useBootstrapData} from '../../../core/bootstrap-data/bootstrap-data-context';\n\nexport function CheckoutStripeDone() {\n  const {invalidateBootstrapData} = useBootstrapData();\n  const {productId, priceId} = useParams();\n  const navigate = useNavigate();\n  const {\n    billing: {stripe_public_key},\n  } = useSettings();\n\n  const [params] = useSearchParams();\n  const clientSecret = params.get('payment_intent_client_secret');\n\n  const [messageConfig, setMessageConfig] =\n    useState<BillingRedirectMessageConfig>();\n\n  const stripeInitiated = useRef<boolean>();\n\n  useEffect(() => {\n    if (stripeInitiated.current) return;\n    loadStripe(stripe_public_key!).then(async stripe => {\n      if (!stripe || !clientSecret) {\n        setMessageConfig(getRedirectMessageConfig());\n        return;\n      }\n      stripe.retrievePaymentIntent(clientSecret).then(({paymentIntent}) => {\n        if (paymentIntent?.status === 'succeeded') {\n          storeSubscriptionDetailsLocally(paymentIntent.id).then(() => {\n            invalidateBootstrapData();\n          });\n        }\n        setMessageConfig(\n          getRedirectMessageConfig(paymentIntent?.status, productId, priceId)\n        );\n      });\n    });\n    stripeInitiated.current = true;\n  }, [\n    stripe_public_key,\n    clientSecret,\n    priceId,\n    productId,\n    invalidateBootstrapData,\n  ]);\n\n  if (!clientSecret) {\n    navigate('/');\n    return null;\n  }\n\n  return (\n    <CheckoutLayout>\n      <BillingRedirectMessage config={messageConfig} />\n      <CheckoutProductSummary showBillingLine={false} />\n    </CheckoutLayout>\n  );\n}\n\nfunction getRedirectMessageConfig(\n  status?: PaymentIntent.Status,\n  productId?: string,\n  priceId?: string\n): BillingRedirectMessageConfig {\n  switch (status) {\n    case 'succeeded':\n      return {\n        message: message('Subscription successful!'),\n        status: 'success',\n        buttonLabel: message('Return to site'),\n        link: '/billing',\n      };\n    case 'processing':\n      return {\n        message: message(\n          \"Payment processing. We'll update you when payment is received.\"\n        ),\n        status: 'success',\n        buttonLabel: message('Return to site'),\n        link: '/billing',\n      };\n    case 'requires_payment_method':\n      return {\n        message: message('Payment failed. Please try another payment method.'),\n        status: 'error',\n        buttonLabel: message('Go back'),\n        link: errorLink(productId, priceId),\n      };\n    default:\n      return {\n        message: message('Something went wrong'),\n        status: 'error',\n        buttonLabel: message('Go back'),\n        link: errorLink(productId, priceId),\n      };\n  }\n}\n\nfunction errorLink(productId?: string, priceId?: string): string {\n  return productId && priceId ? `/buy/${productId}/${priceId}` : '/';\n}\n\nfunction storeSubscriptionDetailsLocally(paymentIntentId: string) {\n  return apiClient.post('billing/stripe/store-subscription-details-locally', {\n    payment_intent_id: paymentIntentId,\n  });\n}\n","import {CheckoutLayout} from '../checkout-layout';\nimport {useParams, useSearchParams} from 'react-router-dom';\nimport {useEffect, useState} from 'react';\nimport {message} from '@common/i18n/message';\nimport {CheckoutProductSummary} from '../checkout-product-summary';\nimport {\n  BillingRedirectMessage,\n  BillingRedirectMessageConfig,\n} from '../../billing-redirect-message';\nimport {apiClient} from '@common/http/query-client';\nimport {useBootstrapData} from '@common/core/bootstrap-data/bootstrap-data-context';\n\nexport function CheckoutPaypalDone() {\n  const {invalidateBootstrapData} = useBootstrapData();\n  const {productId, priceId} = useParams();\n  const [params] = useSearchParams();\n\n  const [messageConfig, setMessageConfig] =\n    useState<BillingRedirectMessageConfig>();\n\n  useEffect(() => {\n    const subscriptionId = params.get('subscriptionId');\n    const status = params.get('status');\n    setMessageConfig(getRedirectMessageConfig(status, productId, priceId));\n    if (subscriptionId && status === 'success') {\n      storeSubscriptionDetailsLocally(subscriptionId).then(() => {\n        invalidateBootstrapData();\n      });\n    }\n  }, [priceId, productId, params, invalidateBootstrapData]);\n\n  return (\n    <CheckoutLayout>\n      <BillingRedirectMessage config={messageConfig} />\n      <CheckoutProductSummary showBillingLine={false} />\n    </CheckoutLayout>\n  );\n}\n\nfunction getRedirectMessageConfig(\n  status?: 'success' | 'error' | string | null,\n  productId?: string,\n  priceId?: string\n): BillingRedirectMessageConfig {\n  switch (status) {\n    case 'success':\n      return {\n        message: message('Subscription successful!'),\n        status: 'success',\n        buttonLabel: message('Return to site'),\n        link: '/billing',\n      };\n    default:\n      return {\n        message: message('Something went wrong. Please try again.'),\n        status: 'error',\n        buttonLabel: message('Go back'),\n        link: errorLink(productId, priceId),\n      };\n  }\n}\n\nfunction errorLink(productId?: string, priceId?: string): string {\n  return productId && priceId ? `/buy/${productId}/${priceId}` : '/';\n}\n\nfunction storeSubscriptionDetailsLocally(subscriptionId: string) {\n  return apiClient.post('billing/paypal/store-subscription-details-locally', {\n    paypal_subscription_id: subscriptionId,\n  });\n}\n","import {Route, Routes} from 'react-router-dom';\nimport {NotSubscribedRoute} from '../../auth/guards/not-subscribed-route';\nimport {Checkout} from './checkout';\nimport React from 'react';\nimport {CheckoutStripeDone} from './stripe/checkout-stripe-done';\nimport {CheckoutPaypalDone} from './paypal/checkout-paypal-done';\n\nexport default function CheckoutRoutes() {\n  return (\n    <Routes>\n      <Route\n        path=\":productId/:priceId\"\n        element={\n          <NotSubscribedRoute>\n            <Checkout />\n          </NotSubscribedRoute>\n        }\n      />\n      <Route\n        path=\":productId/:priceId/stripe/done\"\n        element={\n          <NotSubscribedRoute>\n            <CheckoutStripeDone />\n          </NotSubscribedRoute>\n        }\n      />\n      <Route\n        path=\":productId/:priceId/paypal/done\"\n        element={\n          <NotSubscribedRoute>\n            <CheckoutPaypalDone />\n          </NotSubscribedRoute>\n        }\n      />\n    </Routes>\n  );\n}\n"],"names":["NotSubscribedRoute","children","isLoggedIn","isSubscribed","useAuth","Navigate","_jsx","Outlet","CheckoutLayout","left","right","useEffect","removeFromLocalStorage","StaticPageTitle","Trans","Navbar","_jsxs","CustomMenu","LocaleSwitcher","endpoint","productId","useCheckoutProduct","priceId","useParams","query","useQuery","fetchProduct","product","_a","price","p","apiClient","response","CheckoutProductSummary","showBillingLine","status","LoadingSkeleton","ProductSummary","m","name","description","FormattedPrice","ProductFeatureList","FormattedCurrency","amount","currency","opacityAnimation","Skeleton","findScript","url","attributes","currentScript","nextScript","createScriptElement","currentScriptClone","isExactMatch","key","insertScriptElement","onSuccess","onError","newScript","processOptions","options","sdkBaseURL","processMerchantID","accumulator","value","queryParams","dataAttributes","objectToQueryString","params","queryString","parseErrorMessage","message","originalErrorText","merchantID","dataMerchantID","newMerchantID","newDataMerchantID","loadScript","PromisePonyfill","getDefaultPromiseImplementation","validateArguments","namespace","existingWindowNamespace","getPayPalWindowNamespace","loadCustomScript","newWindowNamespace","resolve","reject","defaultError","parseMessage","err","usePaypal","data","useProducts","paypalLoadStarted","useRef","paypalButtonsRendered","paypalIsLoaded","setPaypalIsLoaded","useState","paypalElementRef","base_url","stripeEnabled","paypalEnabled","public_key","useSettings","actions","e","Checkout","productQuery","billing","stripe","isLoading","FullPageLoader","products","find","id","parseInt","prices","Fragment","enable","StripeElementsForm","Separator","CheckoutStripeDone","invalidateBootstrapData","useBootstrapData","navigate","useNavigate","stripe_public_key","useSearchParams","clientSecret","get","messageConfig","setMessageConfig","stripeInitiated","current","loadStripe","then","getRedirectMessageConfig","retrievePaymentIntent","paymentIntent","storeSubscriptionDetailsLocally","BillingRedirectMessage","buttonLabel","link","errorLink","paymentIntentId","post","payment_intent_id","CheckoutPaypalDone","subscriptionId","paypal_subscription_id","CheckoutRoutes","Routes","Route"],"mappings":"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"}